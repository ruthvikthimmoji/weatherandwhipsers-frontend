---
const plans = [
    {
        title: "Free Plan",
        price: 0,
        features: ["Every Monday", "Previous Week's News", "Monday's Weather"],
        featuresExcluded: ["Daily Updates", "Upcoming Week's Weather"],
        cta: "Sign up for Free",
    },
    {
        title: "Standard Plan",
        price: 59,
        features: [
            "All of Free Plan",
            "Previous Day's News",
            "Upcoming Week's Weather",
        ],
        featuresExcluded: [],
        cta: "Get Premium",
    },
];
---

<form class="max-w-fit mx-auto" id="subscription-form">
    <div class="mb-5">
        <label
            for="email"
            class="block mb-2 text-sm font-medium text-gray-900 dark:text-white"
            >Your email</label
        >
        <input
            type="email"
            name="email"
            id="email"
            class="bg-gray-50 mb-5 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500"
            placeholder="name@gmail.com"
            required
        />
        <label
            for="location"
            class="block mb-2 text-sm font-medium text-gray-900 dark:text-white"
            >Your location</label
        >
        <input
            type="text"
            name="location"
            id="location"
            class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500"
            placeholder="Pune"
            required
        />
        <div class="w-full mx-auto">
            <div class="md:flex md:justify-center grid">
                {
                    plans.map((plan) => (
                        <div class="w-full max-w-sm my-5 mx-auto md:mx-2 p-4 bg-white border border-gray-200 rounded-lg shadow sm:p-8 dark:bg-gray-800 dark:border-gray-700">
                            <h5 class="mb-4 text-xl font-medium text-gray-500 dark:text-gray-400">
                                {plan.title}
                            </h5>
                            <div class="flex items-baseline text-gray-900 dark:text-white">
                                <span class="text-3xl font-semibold">$</span>
                                <span class="text-5xl font-extrabold tracking-tight">
                                    {plan.price}
                                </span>
                                <span class="ms-1 text-xl font-normal text-gray-500 dark:text-gray-400">
                                    /month
                                </span>
                            </div>
                            <ul role="list" class="space-y-5 my-7">
                                {plan.features.map((feature: string) => (
                                    <li class="flex items-center">
                                        <svg
                                            class="flex-shrink-0 w-4 h-4 text-[#883aea] dark:text-[#883aea]"
                                            aria-hidden="true"
                                            xmlns="http://www.w3.org/2000/svg"
                                            fill="currentColor"
                                            viewBox="0 0 20 20"
                                        >
                                            <path d="M10 .5a9.5 9.5 0 1 0 9.5 9.5A9.51 9.51 0 0 0 10 .5Zm3.707 8.207-4 4a1 1 0 0 1-1.414 0l-2-2a1 1 0 0 1 1.414-1.414L9 10.586l3.293-3.293a1 1 0 0 1 1.414 1.414Z" />
                                        </svg>
                                        <span class="text-base font-normal leading-tight text-gray-500 dark:text-gray-400 ms-3">
                                            {feature}
                                        </span>
                                    </li>
                                ))}

                                {plan.featuresExcluded.map(
                                    (feature: string) => (
                                        <li class="flex line-through decoration-gray-500">
                                            <svg
                                                class="flex-shrink-0 w-4 h-4 text-gray-400 dark:text-gray-500"
                                                aria-hidden="true"
                                                xmlns="http://www.w3.org/2000/svg"
                                                fill="currentColor"
                                                viewBox="0 0 20 20"
                                            >
                                                <path d="M10 .5a9.5 9.5 0 1 0 9.5 9.5A9.51 9.51 0 0 0 10 .5Zm3.707 8.207-4 4a1 1 0 0 1-1.414 0l-2-2a1 1 0 0 1 1.414-1.414L9 10.586l3.293-3.293a1 1 0 0 1 1.414 1.414Z" />
                                            </svg>
                                            <span class="text-base font-normal leading-tight text-gray-500 ms-3">
                                                {feature}
                                            </span>
                                        </li>
                                    ),
                                )}
                            </ul>
                            <button
                                value={plan.title}
                                type="submit"
                                class="text-[#13151a] bottom-0 background-gradient focus:ring-4 focus:outline-none focus:ring-blue-200 dark:bg-blue-600 dark:hover:bg-blue-700 dark:focus:ring-blue-900 font-medium rounded-lg text-sm px-5 py-2.5 inline-flex justify-center w-full text-center"
                            >
                                {plan.cta}
                            </button>
                        </div>
                    ))
                }
            </div>
        </div>
    </div>
</form>
<!-- Dialog for Free Plan -->
<div
    id="freePlanDialog"
    class="fixed inset-0 flex items-center justify-center bg-black bg-opacity-50 hidden"
>
    <div class="bg-white p-6 rounded-lg shadow-lg">
        <h2 class="text-xl font-semibold mb-4">Subscription Successful</h2>
        <p class="mb-4">You have successfully subscribed to the Free Plan!</p>
        <button
            id="freePlanDialogButton"
            class="bg-blue-500 text-white p-2 rounded">OK</button
        >
    </div>
</div>

<!-- Dialog for Standard Plan -->
<div
    id="standardPlanDialog"
    class="fixed inset-0 flex items-center justify-center bg-black bg-opacity-50 hidden"
>
    <div class="bg-white p-6 rounded-lg shadow-lg">
        <h2 class="text-xl font-semibold mb-4">Standard Plan Subscription</h2>
        <p class="mb-4">Proceed with payment to complete your subscription.</p>
        <!-- Add your payment form or gateway integration here -->
        <button
            id="standardPlanDialogButton"
            class="bg-green-500 text-white p-2 rounded"
            >Proceed to Payment</button
        >
    </div>
</div>

<script>
    const form = document.getElementById(
        "subscription-form",
    ) as HTMLFormElement;

    const handleSubscriptionForm = (event: SubmitEvent) => {
        event.preventDefault();
        const formData = {
            email: (document.getElementsByName("email")[0] as HTMLInputElement)
                .value,
            location: (
                document.getElementsByName("location")[0] as HTMLInputElement
            ).value,
            plan: (event.submitter as HTMLButtonElement).value,
        };
        if (formData.plan === "Free Plan") {
            openDialog("freePlanDialog");
        } else if (formData.plan === "Standard Plan") {
            openDialog("standardPlanDialog");
        }
    };

    function openDialog(dialogId: string) {
        document.getElementById(dialogId)?.classList.remove("hidden");
    }

    function closeFreeDialog() {
        document.getElementById("freePlanDialog")?.classList.add("hidden");
    }

    function closeStandardDialog() {
        document.getElementById("standardPlanDialog")?.classList.add("hidden");
    }

    document
        .getElementById("freePlanDialogButton")
        ?.addEventListener("click", closeFreeDialog, true);
    document
        .getElementById("standardPlanDialogButton")
        ?.addEventListener("click", closeStandardDialog, true);
    form?.addEventListener("submit", handleSubscriptionForm, true);
</script>
